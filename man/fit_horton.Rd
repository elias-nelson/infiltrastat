% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_horton.R
\name{fit_horton}
\alias{fit_horton}
\title{Fit the Horton Infiltration Model}
\usage{
fit_horton(data = NULL, time, rate, na.rm = TRUE)
}
\arguments{
\item{data}{Optional data frame containing the variables specified
in \code{time} and \code{rate}. If supplied, unquoted column names
should be provided for \code{time} and \code{rate}.}

\item{time}{Numeric vector of time values (must be increasing),
or unquoted column name if \code{data} is provided.}

\item{rate}{Numeric vector of observed infiltration rates,
or unquoted column name if \code{data} is provided.}

\item{na.rm}{Logical; if \code{TRUE} (default), missing values are
removed before model fitting.}
}
\value{
A structured list with class \code{"infiltra_model"}
containing:
\itemize{
\item \code{model} – Character string identifying the model.
\item \code{parameters} – Data frame of estimated parameters
(\eqn{f_c}, \eqn{f_0}, \eqn{k}).
\item \code{fitted} – Data frame with time, observed values,
predicted values, and residuals.
\item \code{performance} – Data frame of goodness-of-fit
statistics (RMSE, MAE, NRMSE, PBIAS, R², NSE, AIC).
\item \code{nls_obj} – The fitted \code{nlsLM} model object.
}
}
\description{
Fits the Horton (1940) exponential decay model to observed soil
infiltration rate data using nonlinear least squares with bounded
optimization via \code{minpack.lm::nlsLM}. The function provides
automatic starting values, parameter estimation, model diagnostics,
and commonly used goodness-of-fit statistics.
}
\details{
The Horton model is defined as:
\deqn{f(t) = f_c + (f_0 - f_c) e^{-k t}}
where \eqn{f_0} is the initial infiltration rate,
\eqn{f_c} is the equilibrium (final) infiltration rate,
and \eqn{k} is the decay constant.

Starting parameter values are automatically estimated from the data
using heuristic rules to improve convergence stability. The decay
constant is initialized via linearization of the exponential form
when possible. Parameter bounds are constrained to non-negative values.

The function computes standard hydrological performance metrics
including Nash–Sutcliffe Efficiency (NSE), Percent Bias (PBIAS),
and Normalized Root Mean Square Error (NRMSE).
}
\examples{
# Example using synthetic data
set.seed(123)
time <- seq(0, 60, by = 5)
rate <- 5 + (20 - 5) * exp(-0.08 * time) + rnorm(length(time), 0, 0.5)

model <- fit_horton(time = time, rate = rate)

model$parameters
model$performance
}
